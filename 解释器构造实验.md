# 解释器构造实验

## CMM语言

CMM（C Minus Minus／C- -）语言为C语言的一个子集，其基础定义如下：

- 语言结构：顺序结构（赋值语句、输入、输出）、选择语句（if-else）、循环结构（while）。这些语句结构和C语言的结构一样，允许嵌套。
- 表达式局限于关系表达式和算术表达式，运算的优先级为：算术运算、关系运算，并服从左结合规则。
- 算术表达式包括整数和实数上的运算、变量及“（）”、“\*”、“+”、“-”、“/”，运算符的优先级顺序为：“（）”大于“*”和“/”大于“+”和“-”。
- 关系运算符包括：“<”、“==”、“<>”。 
- 一条语句以“；”结束；程序由一条语句或者由“{”和“}”嵌套表达的复合语句。
- 支持多行注释（使用“/*”和“\* ”）。
- 支持数组运算，数组的下标必须是正整数，使用“[”和“]”表示数组下标。
- 数组声明方式和Java一样，如，`int[]`，可以直接通过获得数组的长度。
- 变量的使用之前需要先声明，声明的方式和C语言一样。
- 十进制的整数与实数。
- 标识符（由数字、字母和下划线组成的串，但必须以字母开头、且不能以下划线结尾的串）。​	

| 保留字 | 特殊符号 |
| ------ | -------- |
| if     | +        |
| else   | -        |
| while  | *        |
| read   | /        |
| write  | =        |
| int    | <        |
| real   | >        |
| bool   | ==       |
|        | <>       |
|        | (        |
|        | )        |
|        | {        |
|        | }        |
|        | /*       |
|        | */       |
|        | [        |
|        | ]        |
|        | ;        |
|        | .        |

### 词法分析（EBNF）

| 类型                     | 定义为 |                                                    |
| ------------------------ | ------ | -------------------------------------------------- |
| VarDeclaration           | ::=    | Type Identifier ";"                                |
| Type                     | ::=    | Identifier                                         |
|                          |        | \| BooleanType                                     |
|                          |        | \| IntegerType                                     |
|                          |        | \| RealType                                        |
|                          |        | \|  ArrayType                                      |
| ArrayType                | ::=    | "int" "[" "]"                                      |
| ==（与Java类似）==       |        | \| "real" "[" "]"                                  |
|                          |        | \| "bool" "[" "]"                                  |
| BooleanType              | ::=    | "bool"                                             |
| IntegerType              | ::=    | "int"                                              |
| Statement                | ::=    | Block                                              |
|                          |        | \|  AssignmentStatement                            |
|                          |        | \|  ArrayAssignmentStatement                       |
|                          |        | \|  IfStatement                                    |
|                          |        | \|  WhileStatement                                 |
|                          |        | \|  ReadStatement                                  |
|                          |        | \|  WriteStatement                                 |
| Block                    | ::=    | "{" ( Statement )\* "}"                            |
| AssignmentStatement      | ::=    | Identifier "=" Expression ";"                      |
| ArrayAssignmentStatement | ::=    | Identifier "[" Expression "]" "=" Expression ";"   |
| IfStatement              | ::=    | "if" "(" Expression ")" Statement "else" Statement |
| WhileStatement           | ::=    | "while" "(" Expression ")" Statement               |
| WriteStatement           | ::=    | "write" "(" Expression ")" ";"                     |
| ReadStatement            | ::=    | "read"  "(" Expression ")" ";"                     |
| Expression               | ::=    | PlusExpression                                     |
|                          |        | \| MinusExpression                                 |
|                          |        | \|  TimesExpression                                |
|                          |        | \|  DivideExpression                               |
|                          |        | \|  CompareExpression                              |
|                          |        | \|  ArrayLookup                                    |
|                          |        | \|  ArrayLength                                    |
|                          |        | \|  PrimaryExpression                              |
| CompareExpression        | ::=    | PrimaryExpression "<" PrimaryExpression            |
|                          |        | \|  PrimaryExpression ">" PrimaryExpression        |
|                          |        | \|  PrimaryExpression "<>" PrimaryExpression       |
| PlusExpression           | ::=    | PrimaryExpression "+" PrimaryExpression            |
| MinusExpression          | ::=    | PrimaryExpression "-" PrimaryExpression            |
| TimesExpression          | ::=    | PrimaryExpression "\*" PrimaryExpression           |
| DivideExpression          | ::=    | PrimaryExpression "/" PrimaryExpression           |
| ArrayLookup              | ::=    | PrimaryExpression "[" PrimaryExpression "]"        |
| ArrayLength              | ::=    | PrimaryExpression "." "length"                     |
| ExpressionList           | ::=    | Expression ( ExpressionRest )\*                    |
| ExpressionRest           | ::=    | "," Expression                                     |
| PrimaryExpression        | ::=    | IntegerLiteral                                     |
|                          |        | \|  RealLiteral                                    |
|                          |        | \|  TrueLiteral                                    |
|                          |        | \|  FalseLiteral                                   |
|                          |        | \|  BracketExpression                              |
|                          |        | \|  Identifier                                     |
| IntegerLiteral           | ::=    | <INTEGER_LITERAL>                                  |
| RealLiteral              | ::=    | <REAL_LITERAL>                                     |
| TrueLiteral              | ::=    | "true"                                             |
| FalseLiteral             | ::=    | "false"                                            |
| Identifier               | ::=    | \<IDENTIFIER>                                      |
| BracketExpression        | ::=    | "(" Expression ")"                                 |

### 语法分析（EBNF）

### 语义分析（非形式化描述）

